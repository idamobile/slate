<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Smart Transactions</title>
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
<nav>
    <div>
        <a href="about.html">О решении</a>
        <a href="architecture.html">Архитектура</a>
        <a class="active" href="installation.html">Установка</a>
        <a href="protocol.html">Протокол</a>
        <a href="faq.html">Вопросы</a>
    </div>
</nav>
<div>

<h2>Предусловия</h2>
<p>Для установки сервиса SmartTransactions необходимо наличие следующих запущенных сервисов:</p>
<ul>
<li>Apache Tomcat 7.x</li>
<li>Postgres 9.x</li>
</ul>
<h2>Содержимое поставки</h2>
<ul>
<li>SmartTransactionsEndpoint.war веб-приложение сервиса</li>
<li>merchants_dump.sql - дамп базы</li>
</ul>
<h2>Инструкция по установке</h2>
<ol>
<li>Остановить Tomcat с текущей установкой SmartTransactions</li>
<li>Удалить базу smarttransactions (данные и схему)</li>
<li>Создать базу пустую smarttransactions с владельцем dbUsername/dbPassword (параметры используются ниже в настройках подключения)</li>
<li>Выполнить предоставленный скрипт: <code>psql -U &lt;username&gt; -W smarttransactions &lt; merchants_dump.sql</code></li>
<li>Скопировать <code>SmartTransactionsEndpoint.war</code> в <code>${TOMCAT_HOME}/webapps</code></li>
</ol>
<h2>Настройка приложения</h2>
<p>Следующие параметры приложения находятся в файле <code>${TOMCAT_HOME}/webapps/SmartTransactionsEndpoint/META-INF/context.xml</code>:</p>
<ul>
<li>dbUrl - строка соединения с базой данных</li>
<li>dbUsername - имя пользователя</li>
<li>dbPassword - пароль</li>
<li>silentMode - true если необходимо влючить приложение только в режим сбора статистики</li>
</ul>
<h2>Проверка успешности установки</h2>
<p>Открыть в браузре <a href="http://127.0.0.1:8080/SmartTransactionsEndpoint/">http://127.0.0.1:8080/SmartTransactionsEndpoint/</a>
При успешной установке на открывшейся странице отобразится версия сборки, Service URL, количество доступных объектов (больше 0)</p>
<h2>Настройка модуля iDaPro</h2>
<p>Приложение Pro имеет доступ к сервису SmartTransactions по протоколу JSON over HTTP.
Для этого файле <code>${PRO_TOMCAT_HOME}/webapps/pro/WEB-INF/classes/smarttransactions.properties</code> требуется указать в свойстве <code>service_url</code> значение Service URL, полученное после установки сервиса SmartTransactions.</p>
<h2>Обновление базы данных</h2>
<ol>
<li>Остановить Tomcat с приложением</li>
<li>Убедиться, что нет открытых соединений с базой данных smarttransactions</li>
<li>Удалить полностью базу smarttransactions</li>
<li>Создать новую базу smarttransactions для используемого ранее пользователя (например, test)</li>
<li>Запустить предоставленный скрипт merchants_dump.sql</li>
<li>Запустить Tomcat</li>
</ol>
<p></div>
</body>
</html></p>